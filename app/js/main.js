'use strict';

var date = new Date(),
    menu = document.querySelector('.main-menu');

//add year in footer
document.querySelector('#year').innerHTML = date.getFullYear();

//toogleMenu
var toogleMenu = function toogleMenu(e) {
    document.querySelector('.main-menu-list').classList.toggle('active');
    document.querySelector('.toggle-main-menu').classList.toggle('active');
    document.querySelector('body').classList.toggle('fixed');
    e.preventDefault();
};

document.querySelector('.main-menu').addEventListener('click', function (e) {
    if (hasClass(e.target, 'toggle-main-menu')) {
        toogleMenu(e);
    } else if (e.target.className === 'main-menu-link') {
        scrollToY(document.querySelector('.' + e.target.getAttribute('href')).offsetTop, 1500, 'easeInOutQuint');
        toogleMenu(e);
        e.preventDefault();
    } else return false;
});

//requestAnimFrame function
window.requestAnimFrame = function () {
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (callback) {
        window.setTimeout(callback, 1000 / 60);
    };
}();

//has ClassName
function hasClass(elem, className) {
    return (" " + elem.className + " ").indexOf(" " + className + " ") > -1;
}

// scroll to el function
function scrollToY(scrollTargetY, speed, easing) {

    var scrollY = window.scrollY,
        scrollTargetY = scrollTargetY || 0,
        speed = speed || 2000,
        easing = easing || 'easeOutSine',
        currentTime = 0;

    var time = Math.max(.1, Math.min(Math.abs(scrollY - scrollTargetY) / speed, .8));

    var PI_D2 = Math.PI / 2,
        easingEquations = {
        easeOutSine: function easeOutSine(pos) {
            return Math.sin(pos * (Math.PI / 2));
        },
        easeInOutSine: function easeInOutSine(pos) {
            return -0.5 * (Math.cos(Math.PI * pos) - 1);
        },
        easeInOutQuint: function easeInOutQuint(pos) {
            if ((pos /= 0.5) < 1) {
                return 0.5 * Math.pow(pos, 5);
            }
            return 0.5 * (Math.pow(pos - 2, 5) + 2);
        }
    };

    function tick() {
        currentTime += 1 / 60;

        var p = currentTime / time;
        var t = easingEquations[easing](p);

        if (p < 1) {
            requestAnimFrame(tick);

            window.scrollTo(0, scrollY + (scrollTargetY - scrollY) * t);
        } else {
            window.scrollTo(0, scrollTargetY);
        }
    }

    tick();
}

// throttle function
function throttle(func, ms) {

    var isThrottled = false,
        savedArgs = void 0,
        savedThis = void 0;

    function wrapper() {

        if (isThrottled) {
            savedArgs = arguments;
            savedThis = this;
            return;
        }

        func.apply(this, arguments);

        isThrottled = true;

        setTimeout(function () {
            isThrottled = false;
            if (savedArgs) {
                wrapper.apply(savedThis, savedArgs);
                savedArgs = savedThis = null;
            }
        }, ms);
    }

    return wrapper;
}

// parallax el
var parallaxEl = document.querySelectorAll('.parallax');
var parallax = function parallax() {
    var scrolltop = window.pageYOffset;
    for (var i = 0; i < parallaxEl.length; i++) {
        var data = parallaxEl[i].dataset;

        data.direction ? data.direction : data.direction = 0;
        data.position ? data.position : data.position = 0;
        data.speed ? data.speed : data.speed = 0.2;

        var topPosition = (Number(data.direction + scrolltop) + Number(data.position * 2)) * data.speed;
        var direction = data.direction === '-' ? topPosition < data.stop : topPosition > data.stop;

        if (data.stop !== '' && direction) {
            topPosition = data.stop;
        } else {
            topPosition;
        }

        parallaxEl[i].style.transform = 'translateY(' + topPosition + 'px)';
    }
};
window.addEventListener('scroll', function () {
    if (window.innerWidth > 1024) {
        throttle(requestAnimationFrame(parallax), 50);
    }
}, false);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZGF0ZSIsIkRhdGUiLCJtZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJIVE1MIiwiZ2V0RnVsbFllYXIiLCJ0b29nbGVNZW51IiwiZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInByZXZlbnREZWZhdWx0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhc0NsYXNzIiwidGFyZ2V0IiwiY2xhc3NOYW1lIiwic2Nyb2xsVG9ZIiwiZ2V0QXR0cmlidXRlIiwib2Zmc2V0VG9wIiwid2luZG93IiwicmVxdWVzdEFuaW1GcmFtZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1velJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNhbGxiYWNrIiwic2V0VGltZW91dCIsImVsZW0iLCJpbmRleE9mIiwic2Nyb2xsVGFyZ2V0WSIsInNwZWVkIiwiZWFzaW5nIiwic2Nyb2xsWSIsImN1cnJlbnRUaW1lIiwidGltZSIsIk1hdGgiLCJtYXgiLCJtaW4iLCJhYnMiLCJQSV9EMiIsIlBJIiwiZWFzaW5nRXF1YXRpb25zIiwiZWFzZU91dFNpbmUiLCJwb3MiLCJzaW4iLCJlYXNlSW5PdXRTaW5lIiwiY29zIiwiZWFzZUluT3V0UXVpbnQiLCJwb3ciLCJ0aWNrIiwicCIsInQiLCJzY3JvbGxUbyIsInRocm90dGxlIiwiZnVuYyIsIm1zIiwiaXNUaHJvdHRsZWQiLCJzYXZlZEFyZ3MiLCJzYXZlZFRoaXMiLCJ3cmFwcGVyIiwiYXJndW1lbnRzIiwiYXBwbHkiLCJwYXJhbGxheEVsIiwicXVlcnlTZWxlY3RvckFsbCIsInBhcmFsbGF4Iiwic2Nyb2xsdG9wIiwicGFnZVlPZmZzZXQiLCJpIiwibGVuZ3RoIiwiZGF0YSIsImRhdGFzZXQiLCJkaXJlY3Rpb24iLCJwb3NpdGlvbiIsInRvcFBvc2l0aW9uIiwiTnVtYmVyIiwic3RvcCIsInN0eWxlIiwidHJhbnNmb3JtIiwiaW5uZXJX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UyxLQUFkLENBQW9CQyxTQUFwQixHQUFnQyxnQkFBZ0JKLFdBQWhCLEdBQThCLEtBQTlEO0FBQ0Q7QUFDRixDQXBCRDtBQXFCRXJELE9BQU9QLGdCQUFQLENBQXdCLFFBQXhCLEVBQWtDLFlBQU07QUFDdEMsUUFBSU8sT0FBTzBELFVBQVAsR0FBb0IsSUFBeEIsRUFBOEI7QUFDNUJ6QixpQkFBVS9CLHNCQUFzQjBDLFFBQXRCLENBQVYsRUFBMkMsRUFBM0M7QUFDRDtBQUNGLENBSkQsRUFJRyxLQUpIIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCksXHJcbiAgICAgIG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi1tZW51Jyk7XHJcblxyXG4vL2FkZCB5ZWFyIGluIGZvb3RlclxyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjeWVhcicpLmlubmVySFRNTCA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuXHJcbi8vdG9vZ2xlTWVudVxyXG5jb25zdCB0b29nbGVNZW51ID0gKGUpID0+IHtcclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi1tZW51LWxpc3QnKS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9nZ2xlLW1haW4tbWVudScpLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5jbGFzc0xpc3QudG9nZ2xlKCdmaXhlZCcpO1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxufTtcclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluLW1lbnUnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgaWYgKGhhc0NsYXNzKGUudGFyZ2V0LCAndG9nZ2xlLW1haW4tbWVudScpKXtcclxuICAgIHRvb2dsZU1lbnUoZSk7XHJcbiAgfSBlbHNlIGlmIChlLnRhcmdldC5jbGFzc05hbWUgPT09ICdtYWluLW1lbnUtbGluaycpIHtcclxuICAgIHNjcm9sbFRvWShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpKS5vZmZzZXRUb3AsIDE1MDAsICdlYXNlSW5PdXRRdWludCcpO1xyXG4gICAgdG9vZ2xlTWVudShlKTtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICB9IGVsc2UgIHJldHVybiBmYWxzZVxyXG59KTtcclxuXHJcbi8vcmVxdWVzdEFuaW1GcmFtZSBmdW5jdGlvblxyXG53aW5kb3cucmVxdWVzdEFuaW1GcmFtZSA9IChmdW5jdGlvbigpe1xyXG4gIHJldHVybiAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSAgICAgICB8fFxyXG4gICAgICAgICAgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgICAgICAgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSAgICB8fFxyXG4gICAgICAgICAgZnVuY3Rpb24oIGNhbGxiYWNrICl7XHJcbiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGNhbGxiYWNrLCAxMDAwIC8gNjApO1xyXG4gICAgICAgICAgfTtcclxufSkoKTtcclxuXHJcbi8vaGFzIENsYXNzTmFtZVxyXG5mdW5jdGlvbiBoYXNDbGFzcyggZWxlbSwgY2xhc3NOYW1lICkge1xyXG4gICAgIHJldHVybiAoXCIgXCIgKyBlbGVtLmNsYXNzTmFtZSArIFwiIFwiICkuaW5kZXhPZiggXCIgXCIrY2xhc3NOYW1lK1wiIFwiICkgPiAtMTtcclxufVxyXG5cclxuLy8gc2Nyb2xsIHRvIGVsIGZ1bmN0aW9uXHJcbmZ1bmN0aW9uIHNjcm9sbFRvWShzY3JvbGxUYXJnZXRZLCBzcGVlZCwgZWFzaW5nKSB7XHJcblxyXG4gICAgdmFyIHNjcm9sbFkgPSB3aW5kb3cuc2Nyb2xsWSxcclxuICAgICAgICBzY3JvbGxUYXJnZXRZID0gc2Nyb2xsVGFyZ2V0WSB8fCAwLFxyXG4gICAgICAgIHNwZWVkID0gc3BlZWQgfHwgMjAwMCxcclxuICAgICAgICBlYXNpbmcgPSBlYXNpbmcgfHwgJ2Vhc2VPdXRTaW5lJyxcclxuICAgICAgICBjdXJyZW50VGltZSA9IDA7XHJcblxyXG4gICAgbGV0IHRpbWUgPSBNYXRoLm1heCguMSwgTWF0aC5taW4oTWF0aC5hYnMoc2Nyb2xsWSAtIHNjcm9sbFRhcmdldFkpIC8gc3BlZWQsIC44KSk7XHJcblxyXG4gICAgbGV0IFBJX0QyID0gTWF0aC5QSSAvIDIsXHJcbiAgICAgICAgZWFzaW5nRXF1YXRpb25zID0ge1xyXG4gICAgICAgICAgICBlYXNlT3V0U2luZTogZnVuY3Rpb24gKHBvcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguc2luKHBvcyAqIChNYXRoLlBJIC8gMikpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlYXNlSW5PdXRTaW5lOiBmdW5jdGlvbiAocG9zKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0wLjUgKiAoTWF0aC5jb3MoTWF0aC5QSSAqIHBvcykgLSAxKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVhc2VJbk91dFF1aW50OiBmdW5jdGlvbiAocG9zKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHBvcyAvPSAwLjUpIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwLjUgKiBNYXRoLnBvdyhwb3MsIDUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDAuNSAqIChNYXRoLnBvdygocG9zIC0gMiksIDUpICsgMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHRpY2soKSB7XHJcbiAgICAgICAgY3VycmVudFRpbWUgKz0gMSAvIDYwO1xyXG5cclxuICAgICAgICBsZXQgcCA9IGN1cnJlbnRUaW1lIC8gdGltZTtcclxuICAgICAgICBsZXQgdCA9IGVhc2luZ0VxdWF0aW9uc1tlYXNpbmddKHApO1xyXG5cclxuICAgICAgICBpZiAocCA8IDEpIHtcclxuICAgICAgICAgICAgcmVxdWVzdEFuaW1GcmFtZSh0aWNrKTtcclxuXHJcbiAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCBzY3JvbGxZICsgKChzY3JvbGxUYXJnZXRZIC0gc2Nyb2xsWSkgKiB0KSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIHNjcm9sbFRhcmdldFkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aWNrKCk7XHJcbn1cclxuXHJcbi8vIHRocm90dGxlIGZ1bmN0aW9uXHJcbiAgZnVuY3Rpb24gdGhyb3R0bGUoZnVuYywgbXMpIHtcclxuXHJcbiAgICBsZXQgaXNUaHJvdHRsZWQgPSBmYWxzZSxcclxuICAgICAgc2F2ZWRBcmdzLFxyXG4gICAgICBzYXZlZFRoaXM7XHJcblxyXG4gICAgZnVuY3Rpb24gd3JhcHBlcigpIHtcclxuXHJcbiAgICAgIGlmIChpc1Rocm90dGxlZCkge1xyXG4gICAgICAgIHNhdmVkQXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICBzYXZlZFRoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG5cclxuICAgICAgaXNUaHJvdHRsZWQgPSB0cnVlO1xyXG5cclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICBpc1Rocm90dGxlZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChzYXZlZEFyZ3MpIHtcclxuICAgICAgICAgIHdyYXBwZXIuYXBwbHkoc2F2ZWRUaGlzLCBzYXZlZEFyZ3MpO1xyXG4gICAgICAgICAgc2F2ZWRBcmdzID0gc2F2ZWRUaGlzID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIG1zKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gd3JhcHBlcjtcclxuICB9XHJcblxyXG4vLyBwYXJhbGxheCBlbFxyXG5jb25zdCBwYXJhbGxheEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBhcmFsbGF4Jyk7XHJcbmNvbnN0IHBhcmFsbGF4ID0gKCkgPT4ge1xyXG4gIGNvbnN0IHNjcm9sbHRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldDtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFsbGF4RWwubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBkYXRhID0gcGFyYWxsYXhFbFtpXS5kYXRhc2V0O1xyXG5cclxuICAgIGRhdGEuZGlyZWN0aW9uPyBkYXRhLmRpcmVjdGlvbjogZGF0YS5kaXJlY3Rpb24gPSAwXHJcbiAgICBkYXRhLnBvc2l0aW9uPyBkYXRhLnBvc2l0aW9uOiBkYXRhLnBvc2l0aW9uID0gMFxyXG4gICAgZGF0YS5zcGVlZD8gZGF0YS5zcGVlZDogZGF0YS5zcGVlZCA9IDAuMlxuXHJcbiAgICBsZXQgdG9wUG9zaXRpb24gPSAoTnVtYmVyKGRhdGEuZGlyZWN0aW9uICsgc2Nyb2xsdG9wKSArIE51bWJlcihkYXRhLnBvc2l0aW9uICogMikpKiBkYXRhLnNwZWVkO1xyXG4gICAgbGV0IGRpcmVjdGlvbiA9IGRhdGEuZGlyZWN0aW9uID09PSAnLSc/IHRvcFBvc2l0aW9uIDwgZGF0YS5zdG9wOiB0b3BQb3NpdGlvbiA+IGRhdGEuc3RvcDtcclxuXHJcbiAgICBpZiAoZGF0YS5zdG9wICE9PSAnJyAmJiBkaXJlY3Rpb24pIHtcclxuICAgICAgdG9wUG9zaXRpb24gPSBkYXRhLnN0b3A7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0b3BQb3NpdGlvblxyXG4gICAgfVxyXG5cclxuICAgIHBhcmFsbGF4RWxbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoJyArIHRvcFBvc2l0aW9uICsgJ3B4KSc7XHJcbiAgfVxyXG59XHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsICgpID0+IHtcclxuICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+IDEwMjQpIHtcclxuICAgICAgdGhyb3R0bGUoIHJlcXVlc3RBbmltYXRpb25GcmFtZShwYXJhbGxheCksIDUwKTtcclxuICAgIH1cclxuICB9LCBmYWxzZSlcclxuIl19
